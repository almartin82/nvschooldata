---
title: "15 Insights from Nevada School Enrollment Data"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{15 Insights from Nevada School Enrollment Data}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  message = FALSE,
  warning = FALSE,
  fig.width = 8,
  fig.height = 5,
  cache = TRUE
)
```

```{r load-packages}
library(nvschooldata)
library(dplyr)
library(tidyr)
library(ggplot2)

theme_set(theme_minimal(base_size = 14))
```

This vignette explores Nevada's public school enrollment data, surfacing key trends and demographic patterns across the available years (2021-2026). Nevada's data includes 17 county-based school districts, Carson City, and 51 charter school operators under the State Public Charter School Authority (SPCSA).

---

## 1. Nevada lost nearly 13,000 students between 2021 and 2026

Nevada was one of America's fastest-growing states for decades, but school enrollment has declined since 2022. The state shed 18,681 students from its 2022 peak to 2026.

```{r statewide-trend}
# Note: 2025 data temporarily unavailable from NDE
enr <- fetch_enr_multi(c(2021:2024, 2026), use_cache = TRUE)

state_totals <- enr |>
  filter(is_district, subgroup == "total_enrollment", grade_level == "TOTAL") |>
  group_by(end_year) |>
  summarize(n_students = sum(n_students, na.rm = TRUE), .groups = "drop") |>
  mutate(change = n_students - lag(n_students),
         pct_change = round(change / lag(n_students) * 100, 2))

stopifnot(nrow(state_totals) > 0)
state_totals
```

```{r statewide-chart}
ggplot(state_totals, aes(x = end_year, y = n_students)) +
  geom_line(linewidth = 1.2, color = "#003366") +
  geom_point(size = 3, color = "#003366") +
  annotate("rect", xmin = 2020.5, xmax = 2022.5, ymin = -Inf, ymax = Inf,
           alpha = 0.1, fill = "red") +
  annotate("text", x = 2021.5, y = max(state_totals$n_students) + 2000,
           label = "COVID era", size = 3, color = "red3") +
  scale_y_continuous(labels = scales::comma) +
  labs(
    title = "Nevada Public School Enrollment (2021-2026)",
    subtitle = "Enrollment peaked in 2022 and has declined since",
    x = "School Year (ending)",
    y = "Total Enrollment"
  )
```

---

## 2. Charter schools crack the top 10 in Nevada

Clark County dominates, but three charter networks (Somerset, Pinecrest, Doral) now enroll more students than most county school districts. Somerset Academy alone enrolls more than 14 of the 17 county districts.

```{r top-districts}
enr_2026 <- fetch_enr(2026, use_cache = TRUE)

top_districts <- enr_2026 |>
  filter(is_district, subgroup == "total_enrollment", grade_level == "TOTAL") |>
  arrange(desc(n_students)) |>
  head(10) |>
  select(district_name, n_students, is_charter)

stopifnot(nrow(top_districts) == 10)
top_districts
```

```{r top-districts-chart}
top_districts |>
  mutate(district_name = forcats::fct_reorder(district_name, n_students),
         sector = ifelse(is_charter, "Charter", "County District")) |>
  ggplot(aes(x = n_students, y = district_name, fill = sector)) +
  geom_col() +
  geom_text(aes(label = scales::comma(n_students)), hjust = -0.1, size = 3.5) +
  scale_x_continuous(labels = scales::comma, expand = expansion(mult = c(0, 0.15))) +
  scale_fill_manual(values = c("Charter" = "#E67300", "County District" = "#003366")) +
  labs(
    title = "Top 10 Nevada Districts by Enrollment (2026)",
    subtitle = "Charter networks now rival mid-size county districts",
    x = "Number of Students",
    y = NULL,
    fill = NULL
  )
```

---

## 3. Hispanic students are 46% of Nevada enrollment, down slightly from 47% in 2021

Hispanic students are the largest demographic group in Nevada public schools at 45.9%, followed by white students at 25.9%. Hispanic share dipped from 46.8% in 2021 to 45.9% in 2026, a modest decrease even as Hispanic students remain the largest group.

```{r demographics}
demographics <- enr_2026 |>
  filter(is_district, grade_level == "TOTAL",
         subgroup %in% c("white", "black", "hispanic", "asian",
                         "native_american", "multiracial", "pacific_islander")) |>
  group_by(subgroup) |>
  summarize(n_students = sum(n_students, na.rm = TRUE), .groups = "drop") |>
  mutate(pct = round(n_students / sum(n_students) * 100, 1)) |>
  arrange(desc(n_students))

stopifnot(nrow(demographics) == 7)
demographics
```

```{r demographics-chart}
demographics |>
  mutate(subgroup = forcats::fct_reorder(subgroup, n_students)) |>
  ggplot(aes(x = n_students, y = subgroup, fill = subgroup)) +
  geom_col(show.legend = FALSE) +
  geom_text(aes(label = paste0(pct, "%")), hjust = -0.1) +
  scale_x_continuous(labels = scales::comma, expand = expansion(mult = c(0, 0.15))) +
  scale_fill_brewer(palette = "Set2") +
  labs(
    title = "Nevada Student Demographics (2026)",
    subtitle = "Hispanic students are the largest group at 45.9%",
    x = "Number of Students",
    y = NULL
  )
```

---

## 4. Las Vegas Metro has 61.6% of all Nevada students

Beyond Las Vegas and Reno, the remaining 68 entities (15 rural county districts plus charter schools) account for 25% of enrollment.

```{r regional}
regional <- enr_2026 |>
  filter(is_district, subgroup == "total_enrollment", grade_level == "TOTAL") |>
  mutate(region = case_when(
    grepl("Clark", district_name) ~ "Las Vegas Metro",
    grepl("Washoe", district_name) ~ "Reno Metro",
    TRUE ~ "Rest of Nevada"
  )) |>
  group_by(region) |>
  summarize(
    n_entities = n_distinct(district_name),
    total_enrollment = sum(n_students, na.rm = TRUE),
    .groups = "drop"
  ) |>
  mutate(pct = round(total_enrollment / sum(total_enrollment) * 100, 1))

stopifnot(nrow(regional) == 3)
regional
```

```{r regional-chart}
regional |>
  mutate(region = factor(region, levels = c("Las Vegas Metro", "Reno Metro", "Rest of Nevada"))) |>
  ggplot(aes(x = region, y = total_enrollment, fill = region)) +
  geom_col(show.legend = FALSE) +
  geom_text(aes(label = paste0(scales::comma(total_enrollment), "\n(", pct, "%)")),
            vjust = -0.2, size = 4) +
  scale_y_continuous(labels = scales::comma, expand = expansion(mult = c(0, 0.15))) +
  scale_fill_manual(values = c("Las Vegas Metro" = "#003366", "Reno Metro" = "#0066CC", "Rest of Nevada" = "#66B2FF")) +
  labs(
    title = "Enrollment by Region (2026)",
    subtitle = "Las Vegas dominates; 'Rest of Nevada' includes rural counties and charters",
    x = NULL,
    y = "Number of Students"
  )
```

---

## 5. Clark County lost 27,706 students since 2021 while Washoe held steady

Clark County (Las Vegas) and Washoe County (Reno) are Nevada's two urban anchors. Clark dropped 8.7% from 2021 to 2026 while Washoe only dropped 2.1%.

```{r growth-data}
growth_data <- enr |>
  filter(is_district, subgroup == "total_enrollment", grade_level == "TOTAL",
         grepl("Clark|Washoe", district_name)) |>
  mutate(county = case_when(
    grepl("Clark", district_name) ~ "Clark County",
    grepl("Washoe", district_name) ~ "Washoe County"
  )) |>
  group_by(county, end_year) |>
  summarize(n_students = sum(n_students, na.rm = TRUE), .groups = "drop") |>
  group_by(county) |>
  mutate(index = round(n_students / first(n_students) * 100, 1)) |>
  ungroup()

stopifnot(nrow(growth_data) > 0)
growth_data
```

```{r growth-chart}
ggplot(growth_data, aes(x = end_year, y = index, color = county)) +
  geom_line(linewidth = 1.2) +
  geom_point(size = 2) +
  geom_hline(yintercept = 100, linetype = "dashed", color = "gray50") +
  annotate("rect", xmin = 2020.5, xmax = 2022.5, ymin = -Inf, ymax = Inf,
           alpha = 0.1, fill = "red") +
  scale_color_manual(values = c("Clark County" = "#BF0A30", "Washoe County" = "#002868")) +
  labs(
    title = "Clark vs Washoe County Enrollment Trends",
    subtitle = "Indexed to 2021 = 100. Clark declining much faster than Washoe.",
    x = "School Year",
    y = "Enrollment Index (2021 = 100)",
    color = "District"
  )
```

---

## 6. Charter enrollment surged 33% while traditional districts lost 30,000 students

The State Public Charter School Authority (SPCSA) oversees Nevada's charter sector. Charters grew from 53,223 students in 2021 to 70,534 in 2026 -- a 33% increase -- while traditional districts lost 30,287 students in the same period.

```{r charter-trend}
charter_trend <- enr |>
  filter(is_district, subgroup == "total_enrollment", grade_level == "TOTAL") |>
  group_by(end_year, is_charter) |>
  summarize(students = sum(n_students, na.rm = TRUE),
            n_districts = n(), .groups = "drop") |>
  mutate(sector = ifelse(is_charter, "Charter", "Traditional"))

stopifnot(nrow(charter_trend) > 0)
charter_trend |> select(end_year, sector, students, n_districts)
```

```{r charter-chart}
ggplot(charter_trend, aes(x = end_year, y = students, color = sector)) +
  geom_line(linewidth = 1.2) +
  geom_point(size = 2) +
  annotate("rect", xmin = 2020.5, xmax = 2022.5, ymin = -Inf, ymax = Inf,
           alpha = 0.1, fill = "red") +
  scale_y_continuous(labels = scales::comma) +
  scale_color_manual(values = c("Charter" = "#E67300", "Traditional" = "#003366")) +
  labs(
    title = "Charter vs Traditional Enrollment Trends (2021-2026)",
    subtitle = "Charters grew 33% while traditional districts declined 7%",
    x = "School Year (ending)",
    y = "Number of Students",
    color = "Sector"
  )
```

---

## 7. Washoe County lost 1,333 students over 5 years

Washoe County (Reno-Sparks) is Nevada's second-largest district. It peaked at 66,541 in 2022 before declining.

```{r washoe}
washoe_data <- enr |>
  filter(is_district, subgroup == "total_enrollment", grade_level == "TOTAL",
         grepl("Washoe", district_name)) |>
  group_by(end_year) |>
  summarize(n_students = sum(n_students, na.rm = TRUE), .groups = "drop") |>
  mutate(change = n_students - lag(n_students),
         pct_change = round(change / lag(n_students) * 100, 2))

stopifnot(nrow(washoe_data) > 0)
washoe_data
```

```{r washoe-chart}
ggplot(washoe_data, aes(x = end_year, y = n_students)) +
  geom_line(linewidth = 1.2, color = "#002868") +
  geom_point(size = 3, color = "#002868") +
  scale_y_continuous(labels = scales::comma, limits = c(0, NA)) +
  labs(
    title = "Washoe County School District Enrollment",
    subtitle = "Reno-Sparks metro area trends (2021-2026)",
    x = "School Year (ending)",
    y = "Total Enrollment"
  )
```

---

## 8. 12th grade has the most students; PK has the fewest

Tracking enrollment by grade reveals a classic pattern: PK is small (13,852), enrollment jumps at K (30,490), and peaks at 12th grade (37,730). Grade-level data is available at the school level.

```{r grade-levels}
grade_data <- enr_2026 |>
  filter(is_school, subgroup == "total_enrollment",
         !grade_level %in% c("TOTAL", "UG", "AD")) |>
  group_by(grade_level) |>
  summarize(n_students = sum(n_students, na.rm = TRUE), .groups = "drop") |>
  mutate(grade_level = factor(grade_level, levels = c("PK", "K", sprintf("%02d", 1:12)))) |>
  filter(!is.na(grade_level))

stopifnot(nrow(grade_data) > 0)
grade_data
```

```{r grade-chart}
ggplot(grade_data, aes(x = grade_level, y = n_students, fill = grade_level)) +
  geom_col(show.legend = FALSE) +
  scale_y_continuous(labels = scales::comma) +
  scale_fill_viridis_d(option = "viridis") +
  labs(
    title = "Nevada Enrollment by Grade Level (2026)",
    subtitle = "School-level aggregation across all districts",
    x = "Grade Level",
    y = "Number of Students"
  )
```

---

## 9. Boys outnumber girls 51.3% to 48.7% statewide

The gender split across Nevada schools is close to even, with a slight male skew consistent with national patterns.

```{r gender}
gender_data <- enr_2026 |>
  filter(is_district, grade_level == "TOTAL",
         subgroup %in% c("male", "female")) |>
  group_by(subgroup) |>
  summarize(n_students = sum(n_students, na.rm = TRUE), .groups = "drop") |>
  mutate(pct = round(n_students / sum(n_students) * 100, 1))

stopifnot(nrow(gender_data) == 2)
gender_data
```

```{r gender-chart}
ggplot(gender_data, aes(x = subgroup, y = n_students, fill = subgroup)) +
  geom_col(show.legend = FALSE) +
  geom_text(aes(label = paste0(scales::comma(n_students), "\n(", pct, "%)")),
            vjust = -0.2, size = 4) +
  scale_y_continuous(labels = scales::comma, expand = expansion(mult = c(0, 0.15))) +
  scale_fill_manual(values = c("female" = "#CC3366", "male" = "#336699")) +
  labs(
    title = "Nevada Enrollment by Gender (2026)",
    subtitle = "Statewide male/female distribution",
    x = NULL,
    y = "Number of Students"
  )
```

---

## 10. Clark County has 5x more EL students than Washoe but similar FRL rates

English Learners, students with IEPs, and Free/Reduced Lunch eligible students represent key populations for educational policy. Clark County has ~46,000 EL students vs Washoe's ~9,200.

```{r special-populations}
special_pops <- enr_2026 |>
  filter(is_district, grade_level == "TOTAL",
         subgroup %in% c("frl", "iep", "el"),
         grepl("Clark|Washoe", district_name)) |>
  mutate(county = ifelse(grepl("Clark", district_name), "Clark County", "Washoe County")) |>
  group_by(county, subgroup) |>
  summarize(n_students = sum(n_students, na.rm = TRUE), .groups = "drop")

stopifnot(nrow(special_pops) == 6)
special_pops
```

```{r special-pops-chart}
ggplot(special_pops, aes(x = subgroup, y = n_students, fill = county)) +
  geom_col(position = "dodge") +
  geom_text(aes(label = scales::comma(n_students)),
            position = position_dodge(width = 0.9), vjust = -0.2, size = 3) +
  scale_y_continuous(labels = scales::comma, expand = expansion(mult = c(0, 0.15))) +
  scale_fill_manual(values = c("Clark County" = "#BF0A30", "Washoe County" = "#002868")) +
  scale_x_discrete(labels = c("el" = "English\nLearners", "frl" = "Free/Reduced\nLunch", "iep" = "Students\nwith IEPs")) +
  labs(
    title = "Special Populations: Clark vs Washoe County (2026)",
    subtitle = "EL, FRL, and IEP student counts",
    x = NULL,
    y = "Number of Students",
    fill = "District"
  )
```

---

## 11. Kindergarten enrollment swung wildly: up 8% in 2022, down 9% in 2024

Kindergarten enrollment is a leading indicator of future trends. Nevada K enrollment hit 34,641 in 2022 then crashed to 28,931 in 2024 before recovering to 30,490 in 2026. Grade-level data is available at the school level.

```{r kindergarten}
k_data <- enr |>
  filter(is_school, subgroup == "total_enrollment", grade_level == "K") |>
  group_by(end_year) |>
  summarize(k_students = sum(n_students, na.rm = TRUE), .groups = "drop") |>
  mutate(change = k_students - lag(k_students),
         pct_change = round(change / lag(k_students) * 100, 2))

stopifnot(nrow(k_data) > 0)
k_data
```

```{r kindergarten-chart}
ggplot(k_data, aes(x = end_year, y = k_students)) +
  geom_line(linewidth = 1.2, color = "#E67300") +
  geom_point(size = 3, color = "#E67300") +
  annotate("rect", xmin = 2020.5, xmax = 2022.5, ymin = -Inf, ymax = Inf,
           alpha = 0.1, fill = "red") +
  scale_y_continuous(labels = scales::comma, limits = c(0, NA)) +
  labs(
    title = "Nevada Kindergarten Enrollment (2021-2026)",
    subtitle = "K enrollment swings from post-COVID recovery to decline and back",
    x = "School Year (ending)",
    y = "Kindergarten Students"
  )
```

---

## 12. Futuro Academy has the highest EL concentration at 41%

English Learner populations vary dramatically. Clark County leads in absolute numbers (45,993), but several charter schools have much higher EL concentrations. Futuro Academy leads at 41.1% EL students, followed by Equipo Academy at 38.5%.

```{r el-district}
el_data <- enr_2026 |>
  filter(is_district, grade_level == "TOTAL", subgroup == "el") |>
  arrange(desc(n_students)) |>
  head(10) |>
  select(district_name, n_students, pct)

stopifnot(nrow(el_data) == 10)
el_data
```

```{r el-chart}
el_data |>
  mutate(district_name = forcats::fct_reorder(district_name, n_students)) |>
  ggplot(aes(x = n_students, y = district_name, fill = pct)) +
  geom_col() +
  geom_text(aes(label = scales::percent(pct, accuracy = 0.1)), hjust = -0.1, size = 3) +
  scale_x_continuous(labels = scales::comma, expand = expansion(mult = c(0, 0.2))) +
  scale_fill_viridis_c(option = "plasma", labels = scales::percent) +
  labs(
    title = "English Learner Enrollment by District (2026)",
    subtitle = "Top 10 districts by EL count; color shows percentage of total enrollment",
    x = "Number of EL Students",
    y = NULL,
    fill = "EL %"
  )
```

---

## 13. Fifteen districts report 100% FRL eligibility

FRL eligibility is a proxy for economic disadvantage. Many charter schools report 100% FRL, along with two rural counties (Esmeralda and Pershing). The variation across districts is enormous.

```{r frl}
frl_data <- enr_2026 |>
  filter(is_district, grade_level == "TOTAL", subgroup == "frl") |>
  mutate(pct_display = round(pct * 100, 1)) |>
  arrange(desc(pct)) |>
  head(15) |>
  select(district_name, n_students, pct_display)

stopifnot(nrow(frl_data) > 0)
frl_data
```

```{r frl-chart}
frl_data |>
  mutate(district_name = forcats::fct_reorder(district_name, pct_display)) |>
  ggplot(aes(x = pct_display, y = district_name, fill = pct_display)) +
  geom_col() +
  geom_text(aes(label = paste0(round(pct_display, 1), "%")), hjust = -0.1, size = 3) +
  scale_x_continuous(expand = expansion(mult = c(0, 0.15))) +
  scale_fill_gradient(low = "#66B2FF", high = "#BF0A30", guide = "none") +
  labs(
    title = "Free/Reduced Lunch Eligibility by District (2026)",
    subtitle = "Top 15 districts by FRL percentage (includes charter schools)",
    x = "Percent FRL Eligible",
    y = NULL
  )
```

---

## 14. Nevada's smallest LEAs are charter schools, not counties

While Esmeralda County (69 students) is the smallest county district, Nevada's smallest LEAs are micro-charters. Nevada State High School II has just 18 students.

```{r smallest}
smallest <- enr_2026 |>
  filter(is_district, subgroup == "total_enrollment", grade_level == "TOTAL") |>
  arrange(n_students) |>
  head(10) |>
  select(district_name, n_students, is_charter)

stopifnot(nrow(smallest) == 10)
smallest
```

```{r smallest-chart}
smallest |>
  mutate(district_name = forcats::fct_reorder(district_name, n_students),
         sector = ifelse(is_charter, "Charter", "County District")) |>
  ggplot(aes(x = n_students, y = district_name, fill = sector)) +
  geom_col() +
  geom_text(aes(label = scales::comma(n_students)), hjust = -0.1, size = 3.5) +
  scale_x_continuous(expand = expansion(mult = c(0, 0.2))) +
  scale_fill_manual(values = c("Charter" = "#E67300", "County District" = "#336699")) +
  labs(
    title = "Nevada's 10 Smallest LEAs (2026)",
    subtitle = "Most are micro-charter schools, not county districts",
    x = "Total Enrollment",
    y = NULL,
    fill = NULL
  )
```

---

## 15. Lyon County has the highest IEP rate among large districts at 17%

Students with IEPs require specialized services. Clark County has the most IEP students by count (44,484), but Lyon County has the highest rate among sizable districts at 17%.

```{r iep}
iep_data <- enr_2026 |>
  filter(is_district, grade_level == "TOTAL", subgroup == "iep") |>
  mutate(pct_display = round(pct * 100, 1)) |>
  arrange(desc(n_students)) |>
  head(10) |>
  select(district_name, n_students, pct_display)

stopifnot(nrow(iep_data) == 10)
iep_data
```

```{r iep-chart}
iep_data |>
  mutate(district_name = forcats::fct_reorder(district_name, n_students)) |>
  ggplot(aes(x = n_students, y = district_name, fill = pct_display)) +
  geom_col() +
  geom_text(aes(label = paste0(round(pct_display, 1), "%")), hjust = -0.1, size = 3) +
  scale_x_continuous(labels = scales::comma, expand = expansion(mult = c(0, 0.15))) +
  scale_fill_viridis_c(option = "cividis") +
  labs(
    title = "Students with IEPs by District (2026)",
    subtitle = "Top 10 districts by IEP count; color shows IEP rate",
    x = "Number of IEP Students",
    y = NULL,
    fill = "IEP %"
  )
```

---

## Summary

Nevada's school enrollment data reveals:
- **Declining enrollment**: The state lost 13,000 students from 2021 to 2026
- **Clark County losses**: The Las Vegas metro lost 27,706 students (8.7%) in 5 years
- **Charter boom**: SPCSA schools grew 33%, adding 17,311 students since 2021
- **Demographic shift**: Hispanic students are 45.9% of enrollment, down from 46.8% in 2021
- **Urban concentration**: 75% of students are in Las Vegas or Reno metro areas
- **Economic need**: Many charter schools and rural counties report near-100% FRL
- **K volatility**: Kindergarten enrollment swung from +8% to -9% year-over-year

These patterns shape school funding debates and facility planning across the Silver State.

---

*Data sourced from the Nevada Department of Education [Enrollment Data](https://doe.nv.gov/offices/office-of-assessment-data-and-accountability-management-adam/accountability/data-requests/enrollment-for-nevada-public-schools).*

---

## Session Info

```{r session-info}
sessionInfo()
```
